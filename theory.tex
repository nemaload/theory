\input{preamble}
%\addbibresource{neuro_theory.bib}

\title{Information-Theoretic and Numerical-Methodological Considerations for Brain Activity Mapping Experimental Design}

%\author[1,2]{\ \lift{$\jointfirst\,$}Adam~H.~Marblestone\rlap{,}}
\author[1,2]{David~A.~Dalrymple}

%\affil[$\jointfirst$]{Joint first authors}
%\affil[$\jointlast$]{Joint last authors}

\newcommand\et{{\em \&}}

\affil[1]{Nemaload, San Francisco, CA{~94107, USA}}
\affil[2]{Media Lab{oratory,} Massachusetts Institute of Technology{, Cambridge,~MA~02139, USA}}

\renewcommand{\maketitlehookc}{{\small\raggedright Correspondence to: \texttt{david\,\textnormal{(at)}\,\,dalrymple.co}}}

\begin{document}
\maketitle
\pagestyle{plain}
\thispagestyle{empty}

\section{Introduction}

\textsc{Imaging} can be defined as the estimation, from sensor readings, of a physical quantity that varies over some particular region of space (and possibly time). In many cases (including almost all medical imaging, except for the humble X-ray), this is a nontrivial inference problem.

In the case of ``brain activity mapping,'' imaging is only one piece of the overall puzzle, which is illustrated in \autoref{fig:puzzle}.

\begin{figure}[p]
\caption{An overview of variables involved in an electro-optical measurement of neural computation.}
\label{fig:puzzle}
\begin{center}
\adjustbox{lap=-4cm,scale=0.72}{
\begin{tikzpicture}[
every node/.style={draw=black,align=center, cloud ignores aspect},
every matrix/.style={row sep=3ex,column sep=0ex},
prod/.style={draw=none,scale=1.08,inner sep=0pt},
fof/.style={shape=ellipse},
choice/.style={},
unk/.style={shape=cloud},
blank/.style={draw=none},
understudy/.style={shape=ellipse}
]
\node[draw=none] {\color{white}:};

%\begin{scope}[yshift=-14.5cm,font=\relsize{0.5}]
    \matrix[draw=none] (m) {
        & & & \node[fof] (model) {Estimated \\ Neural Computation \\ (Model)}; & \\
        & & \node(sysid) {System \\ Identification};& \node[prod] (estcomp) {$\bigotimes$};& \node[unk] (epistemic) {Epistemic \\ Uncertainty};\\
        & & & \node[fof] (esta) {Estimated \\ State \\ History}; & \\
        & & \node[choice] (analysis) {Analysis}; & \node[prod] (estap) {$\bigotimes$};& \node[unk] (roundoff) {Roundoff \& \\ Approximations};\\
        & & \node[fof] (sensor) {Sensor}; & \node[prod] (frames) {$\bigotimes$};& \node[unk] (readn) {Read \\ Noise};\\
        \node[fof] (light) {Light Source}; & & \node[choice] (optics) {Optical \\ System};& \node[prod] (insplane) {$\bigotimes$};& \node[unk] (shot) {Shot \\ Noise};\\
        & & \node[choice] (tracking) {Tracking \\ Stage};& \node[prod] (fluorworld) {$\bigotimes$};& \node[unk] (mechn) {Mechanical \\ Noise};\\
        & \node[choice] (immob) {Immobilization}; & & \node[prod] (fluorposed) {$\bigotimes$};& \node[unk] (squirm) {Worm Movement};\\
        & & & \node[prod] (fluor) {$\bigotimes$};& \node[unk] (thermo) {Thermodynamic \\ Noise}; \\
        & & & \node[fof] (statehist) {Measurable State \\ History}; & \\
        & & \node[choice] (perturb) {Controlled \\ Perturbations};& \node[prod] (statehisp) {$\bigotimes$}; & \node[unk] (squish) {Uncontrolled \\ Environmental \\ Inputs};\\
        & & \node[fof] (unwanted) {Unwanted \\ Perturbations \\ \textit{(e.g. Toxicity)}}; & \node[prod] (actualcomp) {$\bigotimes$}; &\node[unk] (stochast) {Computational \\ Stochasticity};\\
        & \node[prod] (geneticvar) {$\bigotimes$}; & \node[choice] (genetics) {Genetic \\ Engineering}; & \node[understudy] (neuralcomp) {Natural \\  Neural Computation}; & \node[unk] (varia) {Biological \\ Variability};\\
    };

    \coordinate (arrowdrop) at ($ (varia.south)+(0,-7mm) $);

    \begin{scope}[line width=0.6pt,->,>=stealth]
    \draw (neuralcomp) -- (actualcomp);
    \draw (unwanted) -- (actualcomp);
    \draw (stochast) -- (actualcomp);
    \draw (actualcomp) -- (statehisp);
    \draw (perturb) -- (statehisp);
    \draw (perturb) -- (unwanted);
    \draw (squish) -- (statehisp);
    \draw (statehisp) -- (statehist);

    \draw (statehist) -- (fluor);
    \draw (thermo) -- (fluor);
    \draw (fluor) -- (fluorposed);
    \draw (immob) -- (fluorposed);
    \draw (squirm) -- (fluorposed);
    \draw (fluorposed) -- (fluorworld);
    \draw (tracking) -- (fluorworld);
    \draw (mechn) -- (fluorworld);

    \draw (fluorworld) -- (insplane);
    \draw (optics) -- (insplane);
    \draw (optics) -- (sensor);
    \draw (shot) -- (insplane);
    \draw (insplane) -- (frames);
    \draw (sensor) -- (frames);
    \draw (readn) -- (frames);

    \draw (frames) -- (estap);
    \draw (analysis) -- (estap);
    \draw (roundoff) -- (estap);
    \draw (estap) -- (esta);
    \draw (esta) -- (estcomp);
    \draw (epistemic) -- (estcomp);
    \draw (sysid) -- (estcomp);
    \draw (estcomp) -- (model);

    \draw (genetics) -- (geneticvar);
    \draw (varia) -- (arrowdrop) -| (geneticvar);
    \draw (light) |- (geneticvar);
    \draw ($ (immob.south) + (-10pt,0) $) |- ($ (unwanted.west)+(0,5pt) $);
    \draw ($ (geneticvar |- unwanted) + (0,-5pt) $) -- ($ (unwanted.west)+(0,-5pt) $);
    \draw (geneticvar) |- (fluor);
    \draw (optics) -- (light);
    \end{scope}

\end{tikzpicture}
}
\end{center}
\end{figure}


\end{document}

